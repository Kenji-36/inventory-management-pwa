# 今後のタスク・改善提案

## 📅 作成日: 2026年2月13日

このドキュメントは、在庫注文管理システムの今後の拡張・改善タスクをまとめたものです。

---

## 🎯 優先度別タスク

### 🔴 優先度：高（すぐに対応推奨）

#### 1. CI/CDパイプラインの構築 ✅ 完了
**目的**: 自動テスト・デプロイの効率化

**タスク**:
- [x] GitHub Actionsワークフローの作成
  - [x] プルリクエスト時の自動テスト実行
  - [x] mainブランチマージ時の自動デプロイ
  - [ ] テストカバレッジレポートの自動生成（オプション）
- [x] デプロイ前のビルドチェック
- [x] Vercelプレビューデプロイの活用（Vercel自動連携）

**実施内容**:
- ✅ `.github/workflows/test.yml` 作成（Lint + Test + Build）
- ✅ `.github/workflows/e2e.yml` 作成（E2Eテスト）
- ✅ CI-CD-GUIDE.md 作成（初学者向けガイド）
- ✅ GITHUB-SECRETS-SETUP.md 作成（設定手順書）
- ✅ READMEにステータスバッジ追加
- ✅ 全テスト成功確認（41テスト + 5 E2Eテスト）

**完了日**: 2026年2月13日  
**推定工数**: 1-2日 → **実績**: 1日

**参考実装**:
```yaml
# .github/workflows/test.yml
name: Test & Deploy
on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '18'
      - run: npm ci
      - run: npm test
      - run: npm run build
```

---

#### 2. エラー監視・ログ管理 ✅ 完了
**目的**: 本番環境のエラーを早期発見・対応

**タスク**:
- [x] Sentryの導入（エラートラッキング）
- [x] Vercel Analyticsの有効化
- [x] エラーログの集約と通知設定
- [x] パフォーマンスモニタリング

**実施内容**:
- ✅ @sentry/nextjs パッケージインストール
- ✅ Sentry設定ファイル作成（client/server/edge）
- ✅ グローバルエラーページ作成（error.tsx）
- ✅ エラーバウンダリーコンポーネント作成（ErrorBoundaryTest）
- ✅ Vercel Analytics統合（@vercel/analytics）
- ✅ テストページ作成（/test-error）
  - 5種類のエラーテスト方法を実装
  - エラーバウンダリーの動作確認
- ✅ ERROR-MONITORING-GUIDE.md 作成（初学者向けガイド）
- ✅ SENTRY-AUTH-TOKEN-GUIDE.md 作成（認証トークン取得手順）
- ✅ Vercel環境変数設定
- ✅ 動作確認完了（Sentryダッシュボードでエラー確認済み）

**完了日**: 2026年2月15日  
**推定工数**: 1日 → **実績**: 1日

---

#### 3. データベースバックアップ戦略
**目的**: データ損失リスクの最小化

**タスク**:
- [ ] Supabase自動バックアップの確認（7日間保持）
- [ ] 定期的な手動バックアップスクリプト作成
- [ ] バックアップからのリストア手順書作成
- [ ] 重要データのエクスポート機能追加

**推定工数**: 1日

---

### 🟡 優先度：中（近い将来に対応）

#### 4. ユーザー権限管理の強化 ✅ 完了
**目的**: 管理者と一般ユーザーの権限分離

**タスク**:
- [x] ユーザーロール管理画面の実装
  - [x] 管理者専用ダッシュボード（/admin）
  - [x] ユーザー一覧・編集機能
  - [x] 権限設定UI（ロール変更ドロップダウン）
- [x] RLSポリシーの細分化
- [x] 操作ログの記録（監査ログ）

**実施内容**:
- ✅ 管理者専用ダッシュボード `/admin` 作成（ユーザー管理 + 監査ログ閲覧）
- ✅ 管理者用API作成（`/api/admin/users`、`/api/admin/audit-logs`）
- ✅ 監査ログテーブル `audit_logs` 用SQLスクリプト作成
- ✅ 監査ログ記録ヘルパー関数作成（`src/lib/audit-log.ts`）
- ✅ 主要API（注文作成・在庫更新・CSVインポート・ロール変更）に監査ログ追加
- ✅ ヘッダーナビゲーションに管理者メニュー追加（管理者のみ表示）
- ✅ RLSポリシー設定（管理者は全ユーザー閲覧/更新可能、監査ログは管理者のみ閲覧）
- ✅ TypeScript型定義更新（audit_logsテーブル追加）

**完了日**: 2026年2月15日
**推定工数**: 3-4日 → **実績**: 0.5日

---


#### 5. 高度な在庫管理機能 ✅ 完了（2026-02-15）
**目的**: より詳細な在庫管理

**タスク**:
- [x] 入出庫履歴の記録
  - [x] 入庫日時、担当者、理由
  - [x] 出庫日時、担当者、理由
- [x] 在庫移動機能（倉庫間移動） → 入出庫として統合管理
- [x] 棚卸機能
  - [x] 実在庫と理論在庫の差異チェック
  - [x] 差異調整機能（一括調整対応）
- [x] 在庫予測機能（AI/ML）
  - [x] 過去の販売データから需要予測（過去30日間の平均日販ベース）
  - [x] 発注推奨アラート（在庫切れ7日以内で警告）
**推定工数**: 5-7日

**実装内容**:
- `stock_movements` テーブルで全ての在庫変動を記録（入庫/出庫/棚卸調整/注文出庫）
- 入出庫履歴API（`/api/stock-movements`）: 一覧取得＋手動入出庫の記録
- 既存API（在庫更新・注文作成）に入出庫履歴の自動記録を統合
- 高度な在庫管理画面（`/inventory/history`）に3つのタブ:
  - **入出庫履歴**: 種類別フィルタ、変動前後の在庫数表示
  - **棚卸**: 実在庫入力→差異チェック→一括調整
  - **在庫予測**: 平均日販計算、在庫切れ予測日、発注推奨アラート
- 在庫管理ページに「高度な管理」ボタンを追加

---

#### 6. レポート・分析機能の拡張
**目的**: より詳細なビジネスインサイト

**タスク**:
- [ ] カスタムレポート作成機能
- [ ] PDFエクスポート機能
- [ ] Excelエクスポート機能
- [ ] 高度なフィルタリング・ソート
- [ ] ダッシュボードのカスタマイズ
- [ ] 期間比較分析（前月比、前年比）

**推定工数**: 4-5日

---

#### 7. モバイルアプリ対応の強化
**目的**: モバイル体験の最適化

**タスク**:
- [ ] タブレット専用レイアウト
- [ ] オフライン機能の強化
  - [ ] オフライン時のデータキャッシュ拡大
  - [ ] 同期キューの実装
- [ ] プッシュ通知の実装
  - [ ] 低在庫アラート
  - [ ] 新規注文通知
- [ ] ネイティブアプリ化の検討（React Native / Capacitor）

**推定工数**: 5-7日

---

### 🟢 優先度：低（余裕があれば対応）

#### 8. 多言語対応（国際化）
**目的**: グローバル展開への準備

**タスク**:
- [ ] i18n（next-i18next）の導入
- [ ] 日本語・英語の切り替え
- [ ] 通貨・日付フォーマットの地域対応
- [ ] タイムゾーン対応

**推定工数**: 3-4日

---

#### 9. 高度な検索機能
**目的**: データの発見性向上

**タスク**:
- [ ] 全文検索の実装（PostgreSQL Full-Text Search）
- [ ] ファジー検索（曖昧検索）
- [ ] 検索履歴の保存
- [ ] 検索候補のサジェスト
- [ ] 高度なフィルタリング（複数条件AND/OR）

**推定工数**: 3-4日

---

#### 10. サードパーティ連携
**目的**: 外部システムとの統合

**タスク**:
- [ ] 会計ソフト連携（freee、マネーフォワード）
- [ ] ECサイト連携（Shopify、BASE）
- [ ] 配送業者API連携（ヤマト、佐川）
- [ ] メール通知機能（SendGrid、Resend）
- [ ] Slack/Discord通知

**推定工数**: 各連携につき2-3日

---

#### 11. パフォーマンス最適化
**目的**: ユーザー体験の向上

**タスク**:
- [ ] Lighthouseスコアの改善（目標: 90+）
- [ ] 画像の最適化（WebP、AVIF対応）
- [ ] コード分割の最適化
- [ ] データベースクエリの最適化
- [ ] CDNキャッシュ戦略の見直し
- [ ] Core Web Vitalsの改善

**推定工数**: 2-3日

---

#### 12. アクセシビリティ対応
**目的**: すべてのユーザーが使いやすいシステム

**タスク**:
- [ ] WCAG 2.1 AA準拠
- [ ] スクリーンリーダー対応
- [ ] キーボードナビゲーション対応
- [ ] カラーコントラスト比の改善
- [ ] aria属性の追加

**推定工数**: 2-3日

---

## 🔧 技術的負債の解消

### 1. TypeScript型定義の厳格化
- [ ] `any`型の削除
- [ ] 型定義の完全性向上
- [ ] strict modeの有効化

### 2. コンポーネントのリファクタリング
- [ ] 大きなコンポーネントの分割
- [ ] カスタムフックの抽出
- [ ] 共通ロジックの抽象化

### 3. テストカバレッジの向上
- [ ] カバレッジ80%以上を目標
- [ ] 統合テストの追加
- [ ] E2Eテストの拡充（認証付きシナリオ）

---

## 📊 機能追加のアイデア

### ビジネス機能

1. **発注管理機能**
   - 仕入先管理
   - 発注書作成・送信
   - 入荷予定管理

2. **顧客管理機能（CRM）**
   - 顧客情報管理
   - 購買履歴分析
   - リピート率分析

3. **返品・交換管理**
   - 返品理由の記録
   - 返品在庫の管理
   - 返金処理

4. **セール・キャンペーン管理**
   - 割引設定
   - クーポン発行
   - 期間限定価格

5. **複数店舗対応**
   - 店舗別在庫管理
   - 店舗間在庫移動
   - 店舗別売上分析

### 技術的改善

1. **GraphQL APIの導入**
   - REST APIからGraphQLへの移行
   - より柔軟なデータ取得

2. **リアルタイム通知の強化**
   - WebSocket活用
   - Server-Sent Events

3. **AIによる需要予測**
   - 機械学習モデルの導入
   - 季節変動の考慮

---

## 🎓 学習・スキルアップ

プロジェクトをさらに発展させるための学習項目：

1. **データベース設計の深化**
   - インデックス戦略
   - クエリ最適化
   - パーティショニング

2. **セキュリティの強化**
   - OWASP Top 10対策
   - ペネトレーションテスト
   - セキュリティ監査

3. **スケーラビリティ**
   - 負荷分散
   - キャッシュ戦略
   - マイクロサービス化

4. **DevOps**
   - Infrastructure as Code (Terraform)
   - コンテナ化（Docker）
   - Kubernetes

---

## 📝 ドキュメント整備

- [ ] API仕様書の作成（OpenAPI/Swagger）
- [ ] ユーザーマニュアルの作成
- [ ] 運用マニュアルの作成
- [ ] トラブルシューティングガイド
- [ ] オンボーディングガイド（新規開発者向け）

---

## 🚀 推奨実装順序

### フェーズ1: 安定化（1-2週間）
1. ~~CI/CDパイプラインの構築~~ ✅
2. ~~エラー監視・ログ管理~~ ✅
3. データベースバックアップ戦略

### フェーズ2: 機能拡張（2-3週間）
4. ユーザー権限管理の強化
5. 高度な在庫管理機能
6. レポート・分析機能の拡張

### フェーズ3: 体験向上（2-3週間）
7. モバイルアプリ対応の強化
8. パフォーマンス最適化
9. アクセシビリティ対応

### フェーズ4: スケール準備（必要に応じて）
10. サードパーティ連携
11. 多言語対応
12. 高度な検索機能

---

## 💡 ビジネス視点での提案

### 収益化の検討
- [ ] SaaS化（複数企業への提供）
- [ ] プラン別機能制限（Free / Pro / Enterprise）
- [ ] API提供（外部システム連携）

### マーケティング
- [ ] ランディングページの作成
- [ ] デモ環境の構築
- [ ] ドキュメントサイトの公開

### ユーザーフィードバック
- [ ] フィードバック機能の実装
- [ ] ユーザーインタビューの実施
- [ ] A/Bテストの実施

---

## 🔗 参考リソース

### 公式ドキュメント
- [Next.js Documentation](https://nextjs.org/docs)
- [Supabase Documentation](https://supabase.com/docs)
- [Vercel Documentation](https://vercel.com/docs)

### ベストプラクティス
- [React Best Practices](https://react.dev/learn)
- [TypeScript Best Practices](https://www.typescriptlang.org/docs/handbook/declaration-files/do-s-and-don-ts.html)
- [Web.dev Performance](https://web.dev/performance/)

### セキュリティ
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [Supabase Security](https://supabase.com/docs/guides/auth/row-level-security)

---

## 📞 サポート・コミュニティ

- GitHub Issues（バグ報告・機能リクエスト）
- Supabase Discord
- Next.js Discord
- Stack Overflow

---

## ✅ 完了済みタスク

### 2026年2月13日
- [x] **1. CI/CDパイプラインの構築**
  - GitHub Actions ワークフロー作成（Test + E2E Tests）
  - CI/CDガイドドキュメント作成
  - GitHub Secrets設定手順書作成
  - ステータスバッジ追加
  - 全46テスト成功確認

### 2026年2月15日
- [x] **2. エラー監視・ログ管理**
  - Sentryエラートラッキング導入（@sentry/nextjs v10）
  - Vercel Analytics統合（@vercel/analytics）
  - グローバルエラーハンドリング実装（error.tsx）
  - エラーバウンダリーコンポーネント作成
  - テストページ作成（/test-error、5種類のエラーテスト）
  - Sentry設定ファイル整理（重複排除・CSP対応）
  - 初学者向けガイド作成（ERROR-MONITORING-GUIDE.md、SENTRY-AUTH-TOKEN-GUIDE.md）
  - Sentryダッシュボードで5種類のエラー送信を動作確認済み

- [x] **4. ユーザー権限管理の強化**
  - 管理者専用ダッシュボード作成（/admin）
  - ユーザー一覧・ロール変更UI
  - 管理者用API（/api/admin/users、/api/admin/audit-logs）
  - 監査ログテーブル・記録機能実装
  - RLSポリシーの細分化（SQLスクリプト）
  - ヘッダーに管理者メニュー追加（管理者のみ表示）

---

## 📋 進捗サマリー

| # | タスク | 優先度 | 状態 |
|---|--------|--------|------|
| 1 | CI/CDパイプラインの構築 | 🔴 高 | [x] 完了 |
| 2 | エラー監視・ログ管理 | 🔴 高 | [x] 完了 |
| 3 | データベースバックアップ戦略 | 🔴 高 | [ ] 未着手 |
| 4 | ユーザー権限管理の強化 | 🟡 中 | [x] 完了 |
| 5 | 高度な在庫管理機能 | 🟡 中 | [x] 完了 |
| 6 | レポート・分析機能の拡張 | 🟡 中 | [ ] 未着手 |
| 7 | モバイルアプリ対応の強化 | 🟡 中 | [ ] 未着手 |
| 8 | 多言語対応（国際化） | 🟢 低 | [ ] 未着手 |
| 9 | 高度な検索機能 | 🟢 低 | [ ] 未着手 |
| 10 | サードパーティ連携 | 🟢 低 | [ ] 未着手 |
| 11 | パフォーマンス最適化 | 🟢 低 | [ ] 未着手 |
| 12 | アクセシビリティ対応 | 🟢 低 | [ ] 未着手 |

**完了率**: 3 / 12 タスク (25%)

---

**最終更新**: 2026年2月15日  
**次回レビュー推奨**: 2026年3月15日
