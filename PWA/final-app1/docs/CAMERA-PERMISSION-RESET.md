# カメラ許可のリセット方法

`NotAllowedError: Permission denied` エラーが発生している場合、ブラウザでカメラの使用が拒否されています。

## 🔧 Chrome / Edge での解決方法

### 方法1: アドレスバーから設定（最も簡単）

1. **アドレスバーの左側**を確認
   - 🔒（鍵マーク）または ⓘ（情報マーク）が表示されています

2. **その部分をクリック**

3. **「カメラ」の項目を探す**
   - 現在は「ブロック」または「確認」になっているはず

4. **ドロップダウンをクリックして「許可」を選択**

5. **ページをリロード（F5キー）**

### 方法2: サイト設定から変更

1. **アドレスバーの左側の🔒をクリック**

2. **「サイトの設定」をクリック**

3. **「権限」セクションを探す**

4. **「カメラ」の項目を見つける**
   - 「ブロック」になっている場合

5. **「ブロック」をクリックして「許可」に変更**

6. **ページをリロード（F5キー）**

### 方法3: Chrome設定から変更

1. **Chromeの設定を開く**
   - アドレスバーに `chrome://settings/content/camera` と入力してEnter

2. **「ブロック」セクションを確認**
   - `http://localhost:3000` が含まれていないか確認

3. **もし含まれていたら、右側の「︙」をクリック → 「削除」**

4. **「許可」セクションに `http://localhost:3000` を追加**
   - 「追加」ボタンをクリック
   - `http://localhost:3000` と入力
   - 「追加」をクリック

5. **ブラウザタブに戻ってページをリロード（F5キー）**

### 方法4: ブラウザデータをクリア（最終手段）

1. **Ctrl+Shift+Delete** を押す

2. **「期間」を「全期間」に設定**

3. **以下にチェック:**
   - ✅ Cookie と他のサイトデータ
   - ✅ キャッシュされた画像とファイル

4. **「データを削除」をクリック**

5. **ブラウザを再起動**

6. **`http://localhost:3000/inventory` にアクセス**

7. **バーコードスキャンボタンをクリック**

8. **今度は「許可」をクリック**

## 🔍 確認ポイント

### 現在のカメラ設定を確認

1. **アドレスバーに以下を入力:**
   ```
   chrome://settings/content/camera
   ```

2. **「ブロック」セクションを確認**
   - `localhost:3000` が含まれている場合は削除

3. **「許可」セクションを確認**
   - `localhost:3000` が含まれていることを確認

### URLを確認

- ✅ 正しい: `http://localhost:3000/inventory`
- ❌ 間違い: `http://127.0.0.1:3000/inventory`
- ❌ 間違い: `http://192.168.x.x:3000/inventory`

**必ず `localhost` を使用してください。**

## 📱 スマートフォンの場合

### Android（Chrome）

1. **スマホの「設定」アプリを開く**

2. **「アプリ」→「Chrome」をタップ**

3. **「権限」をタップ**

4. **「カメラ」をタップ**

5. **「許可」を選択**

6. **Chromeを完全に終了して再起動**

7. **`http://localhost:3000/inventory` にアクセス**

### iPhone（Safari）

1. **「設定」アプリを開く**

2. **「Safari」をタップ**

3. **「カメラ」を探す**

4. **「許可」または「確認」を選択**

5. **Safariを完全に終了して再起動**

6. **`http://localhost:3000/inventory` にアクセス**

## 🧪 テスト方法

カメラが正しく動作するかテスト:

1. **新しいタブを開く**

2. **以下のサイトにアクセス:**
   ```
   https://webcamtests.com/
   ```

3. **「Test my cam」をクリック**

4. **カメラ許可を求められたら「許可」をクリック**

5. **カメラの映像が表示されればOK**

もしこのテストサイトでもカメラが動作しない場合:
- カメラが他のアプリ（Zoom、Teamsなど）で使用中
- カメラドライバーの問題
- OSのプライバシー設定でカメラがブロックされている

## 💡 よくある原因

### 1. 以前に「ブロック」を選択した

→ 上記の方法で「許可」に変更

### 2. 他のアプリがカメラを使用中

→ Zoom、Teams、Skypeなどを終了

### 3. ブラウザの拡張機能が干渉

→ シークレットモードで試す（Ctrl+Shift+N）

### 4. OSのプライバシー設定（Windows 10/11）

1. **設定** → **プライバシーとセキュリティ**
2. **カメラ**をクリック
3. **「アプリがカメラにアクセスできるようにする」**をオンにする
4. **「デスクトップアプリがカメラにアクセスできるようにする」**もオンにする

## 🆘 それでも解決しない場合

以下を試してください:

1. **別のブラウザで試す**（Firefox、Edgeなど）

2. **シークレットモード/プライベートブラウジングで試す**
   - Chrome: Ctrl+Shift+N
   - Firefox: Ctrl+Shift+P

3. **PCを再起動**

4. **ブラウザを最新版に更新**

5. **カメラドライバーを更新**（Windowsの場合）
   - デバイスマネージャー → カメラ → 右クリック → ドライバーの更新
